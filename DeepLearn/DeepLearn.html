<!DOCTYPE html>
<html lang="en"><head>
<script src="DeepLearn_files/libs/clipboard/clipboard.min.js"></script>
<script src="DeepLearn_files/libs/quarto-html/tabby.min.js"></script>
<script src="DeepLearn_files/libs/quarto-html/popper.min.js"></script>
<script src="DeepLearn_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="DeepLearn_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="DeepLearn_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="DeepLearn_files/libs/quarto-html/quarto-syntax-highlighting-dark-8ef56b68f8fa1e9d2ba328e99e439f80.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.31">

  <title>Neural Networks</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="DeepLearn_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="DeepLearn_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #f07178; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #00e0e0; } /* Attribute */
    code span.bn { color: #d4d0ab; } /* BaseN */
    code span.bu { color: #abe338; } /* BuiltIn */
    code span.cf { color: #ffa07a; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffd700; } /* Constant */
    code span.co { color: #f8f8f2; font-style: italic; } /* Comment */
    code span.cv { color: #ffd700; } /* CommentVar */
    code span.do { color: #f8f8f2; } /* Documentation */
    code span.dt { color: #ffa07a; } /* DataType */
    code span.dv { color: #d4d0ab; } /* DecVal */
    code span.er { color: #f07178; text-decoration: underline; } /* Error */
    code span.ex { color: #00e0e0; font-weight: bold; } /* Extension */
    code span.fl { color: #d4d0ab; } /* Float */
    code span.fu { color: #ffa07a; } /* Function */
    code span.im { color: #abe338; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; font-weight: bold; } /* Keyword */
    code span.op { color: #ffa07a; } /* Operator */
    code span.ot { color: #00e0e0; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.re { color: #00e0e0; background-color: #f8f8f2; } /* RegionMarker */
    code span.sc { color: #abe338; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #00e0e0; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #dcc6e0; } /* Warning */
  </style>
  <link rel="stylesheet" href="DeepLearn_files/libs/revealjs/dist/theme/quarto-4b8217244be6dee95f534ad2017c9ddb.css">
  <link href="DeepLearn_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="DeepLearn_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="DeepLearn_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="DeepLearn_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="DeepLearn_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="DeepLearn_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Neural Networks</h1>

<div class="quarto-title-authors">
</div>

</section>
<section id="learning-outcomes" class="title-slide slide level1 smaller center">
<h1>Learning Outcomes</h1>
<ul>
<li class="fragment"><p>How to work with a graphical representation of a Neural Network</p></li>
<li class="fragment"><p>How to transform the graphical representation into a Neural Network prediction function</p></li>
<li class="fragment"><p>How to use an Optimizer in a Neural Network to change the network’s parameters to step-wise improve the approximation quality</p></li>
<li class="fragment"><p>Why Neural Networks have outstanding approximation qualities that allow them to approximate any continuous function with any degree of accuracy</p></li>
<li class="fragment"><p>How and why the outstanding approximation quality of Neural Networks makes them prone to overfitting</p></li>
<li class="fragment"><p>How to work with the R nnet package and with PyTorch to design and run a Neural Network</p></li>
<li class="fragment"><p>Why a Neural Network with ReLU (Rectified Linear Unit) activation functions has the same outstanding approximation properties as a Neural Network with classic Sigmoid activation functions</p></li>
<li class="fragment"><p>Why ReLU functions mitigate the possible inability of the Optimizer to change the values for the β parameters</p></li>
<li class="fragment"><p>How to use PyTorch in an interactive project to estimate the prices of more than 50,00050,000 diamonds based on four common predictors used in the appraisal industry (Carat, Clarity, Cut, and Color)</p></li>
</ul>
</section>

<section id="the-early-days" class="title-slide slide level1 center">
<h1>The Early Days</h1>
<p>In the early days of artificial neural networks, data scientists tried to mimic the human brain through computer models.</p>

<img data-src="Images/HumanBrain.png" class="quarto-figure quarto-figure-center r-stretch" width="500"></section>

<section id="types-of-neural-networks" class="title-slide slide level1 center">
<h1>Types of Neural Networks</h1>
<ul>
<li class="fragment"><strong>Multi-Layer Perceptrons (MLP)</strong> neural networks (covered here)</li>
<li class="fragment"><a href="https://pytorch.org/tutorials/beginner/blitz/neural_networks_tutorial.html" target="blank_">Convolutional Neural Networks (CNN)</a></li>
<li class="fragment">Recurrent Neural Networks (e.g.&nbsp;Long Short Term Memory recurrent networks)</li>
<li class="fragment">Generative Adversarial Networks</li>
<li class="fragment">AutoEncoders</li>
<li class="fragment">Transformers»</li>
</ul>
</section>

<section id="multi-layer-perceptrons-mlp-neural-network" class="title-slide slide level1 center">
<h1>Multi-Layer Perceptrons (MLP) Neural Network</h1>
<ul>
<li class="fragment"><strong>Input Layer:</strong> with one or more input neurons.</li>
<li class="fragment"><strong>Hidden Layer(s)</strong> one or more hidden layers with one or more hidden neurons.</li>
<li class="fragment"><strong>Output Layer:</strong> with one or more output neurons.</li>
<li class="fragment"><strong>Fully connected:</strong> each neuron in each of the layers is connected to all neurons of the following layer.</li>
</ul>
</section>

<section id="example-for-an-mlp-neural-network-with-one-hidden-layer" class="title-slide slide level1 center">
<h1>Example for an MLP Neural Network with One Hidden Layer</h1>

<img data-src="Images/NeuralNetGraphGeneral.png" class="r-stretch"></section>

<section id="the-data" class="title-slide slide level1 center">
<h1>The Data</h1>
<p>We will estimate diamond prices based on their physical properties and use the well-known <code>diamonds</code> dataset automatically loaded together with <code>tidymodels</code>:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="fu">library</span>(tidymodels); <span class="fu">library</span>(janitor)</span>
<span id="cb1-2"><a href=""></a><span class="fu">str</span>(diamonds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [53,940 × 10] (S3: tbl_df/tbl/data.frame)
 $ carat  : num [1:53940] 0.23 0.21 0.23 0.29 0.31 0.24 0.24 0.26 0.22 0.23 ...
 $ cut    : Ord.factor w/ 5 levels "Fair"&lt;"Good"&lt;..: 5 4 2 4 2 3 3 3 1 3 ...
 $ color  : Ord.factor w/ 7 levels "D"&lt;"E"&lt;"F"&lt;"G"&lt;..: 2 2 2 6 7 7 6 5 2 5 ...
 $ clarity: Ord.factor w/ 8 levels "I1"&lt;"SI2"&lt;"SI1"&lt;..: 2 3 5 4 2 6 7 3 4 5 ...
 $ depth  : num [1:53940] 61.5 59.8 56.9 62.4 63.3 62.8 62.3 61.9 65.1 59.4 ...
 $ table  : num [1:53940] 55 61 65 58 58 57 57 55 61 61 ...
 $ price  : int [1:53940] 326 326 327 334 335 336 336 337 337 338 ...
 $ x      : num [1:53940] 3.95 3.89 4.05 4.2 4.34 3.94 3.95 4.07 3.87 4 ...
 $ y      : num [1:53940] 3.98 3.84 4.07 4.23 4.35 3.96 3.98 4.11 3.78 4.05 ...
 $ z      : num [1:53940] 2.43 2.31 2.31 2.63 2.75 2.48 2.47 2.53 2.49 2.39 ...</code></pre>
</div>
</div>
<div class="footer">
<p>See: <a href="https://ggplot2.tidyverse.org/reference/diamonds.html" target="blank_">Source: <code>diamonds</code> dataset:</a></p>
</div>
</section>

<section id="domain-knowledge-the-four-c-s-to-appraise-a-diamond" class="title-slide slide level1 center">
<h1>Domain Knowledge: The Four C s to Appraise a Diamond</h1>
<ol type="1">
<li class="fragment"><p><strong>Cut:</strong> Refers to the facets, symmetry, and reflective qualities of a diamond. The cut of a diamond is directly related to its overall sparkle and beauty.</p></li>
<li class="fragment"><p><strong>Color:</strong> Refers to the natural color or lack of color visible within a diamond. The closer a diamond is to “colorless,” the higher its value.</p></li>
<li class="fragment"><p><strong>Clarity:</strong> Is the visibility of natural microscopic inclusions and imperfections within a diamond. Diamonds with little to no inclusions are considered particularly rare and highly valued.</p></li>
<li class="fragment"><p><strong>Carat:</strong> Is the unit of measurement used to describe the weight of a diamond. It is often the most visually apparent factor when comparing diamonds.</p></li>
</ol>
<div class="footer">
<p>See: <a href="https://www.brilliantearth.com/diamond/buying-guide/?gclid=CjwKCAjw79iaBhAJEiwAPYwoCCtVM1dC2gPVa-iqaLjcBzcuLiRvBOuKj_qa3eMoKoyMxX-W4MXQPRoCGp0QAvD_BwE" target="blank_">Source: Brilliant Earth</a></p>
</div>
</section>

<section id="data-engeneering" class="title-slide slide level1 center">
<h1>Data Engeneering</h1>
<p>We start with a very basic model with 2 predictors for <span class="math inline">\(Price\)</span>:</p>
<ul>
<li><p><span class="math inline">\(Carat\)</span> (the weight of the diamond in metric grams),</p></li>
<li><p><span class="math inline">\(Clarity\)</span> (eight categories with <span class="math inline">\(8\)</span> being the best).</p></li>
</ul>
<p>To later increase training speed, we use only 10,000 observations.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">777</span>)</span>
<span id="cb3-2"><a href=""></a>DataDiamonds<span class="ot">=</span>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href=""></a>               <span class="fu">clean_names</span>(<span class="st">"upper_camel"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href=""></a>               <span class="fu">select</span>(Price, Carat, Clarity) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href=""></a>               <span class="fu">mutate</span>(<span class="at">Clarity=</span><span class="fu">as.integer</span>(Clarity)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href=""></a>               <span class="fu">sample_n</span>(<span class="dv">10000</span>) </span>
<span id="cb3-7"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">777</span>)</span>
<span id="cb3-8"><a href=""></a>Split70<span class="ot">=</span>DataDiamonds <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href=""></a>  <span class="fu">initial_split</span>(<span class="at">prop =</span> <span class="fl">0.7</span>, <span class="at">strata =</span> Price, <span class="at">breaks =</span> <span class="dv">5</span>)</span>
<span id="cb3-10"><a href=""></a>DataTrain<span class="ot">=</span><span class="fu">training</span>(Split70)</span>
<span id="cb3-11"><a href=""></a>DataTest<span class="ot">=</span><span class="fu">testing</span>(Split70)</span>
<span id="cb3-12"><a href=""></a><span class="fu">print</span>(DataTrain)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6,999 × 3
   Price Carat Clarity
   &lt;int&gt; &lt;dbl&gt;   &lt;int&gt;
 1   506  0.3        3
 2   628  0.28       6
 3   753  0.3        7
 4   766  0.3        6
 5   552  0.35       5
 6   743  0.33       5
 7   698  0.31       4
 8   526  0.3        4
 9   675  0.3        5
10   544  0.31       4
# ℹ 6,989 more rows</code></pre>
</div>
</div>
</section>

<section id="use-a-trained-neural-nework-beta-s-are-known-to-predict" class="title-slide slide level1 center">
<h1>Use a Trained Neural Nework (<span class="math inline">\(\beta s\)</span> are known) to Predict</h1>
<p><strong>Effectiv Inputs to Hidden Neurons:</strong></p>
<p><img data-src="Images/NeuralNetGraphGeneral.png"></p>
<p><img data-src="Images/InpEff1.png" class="fragment absolute" style="top: 278px; left: 470px; "> <img data-src="Images/InpEff2.png" class="fragment absolute" style="top: 550px; left: 470px; "></p>
</section>

<section id="use-a-trained-neural-nework-beta-s-are-known-to-predict-1" class="title-slide slide level1 center">
<h1>Use a Trained Neural Nework (<span class="math inline">\(\beta s\)</span> are known) to Predict</h1>
<p><strong>Calculate Activity in Hidden Neurons with Logistic Function</strong></p>
<p><img data-src="Images/NeuralNetGraphGeneral.png"></p>
<p><img data-src="Images/Act1.png" class="fragment absolute" style="top: 210px; left: 490px; "> <img data-src="Images/Act2.png" class="fragment absolute" style="top: 575px; left: 490px; "></p>
</section>

<section id="use-a-trained-neural-nework-beta-s-are-known-to-predict-2" class="title-slide slide level1 center">
<h1>Use a Trained Neural Nework (<span class="math inline">\(\beta s\)</span> are known) to Predict</h1>
<p><strong>Calculate Prediction from Activities in Hidden Neurons:</strong></p>
<p><img data-src="Images/NeuralNetGraphGeneral.png"></p>
<p><img data-src="Images/Prediction.png" class="fragment absolute" style="top: 497px; left: 735px; "></p>
</section>

<section id="prediction-of-the-neural-network" class="title-slide slide level1 center">
<h1>Prediction of the Neural Network</h1>
<p><span class="math display">\[\widehat P =\beta_7 + \beta_8 A^{ct}_1 +  \beta_9 A^{ct}_2\]</span> A neural network can be transformed into a prediction equation that depends only on the <span class="math inline">\(\beta s\)</span> and the values of the predictor variables!</p>
<p>We will show this in more detail on the following slides.»</p>
</section>

<section id="transformation-from-neural-network-to-prediction-equation" class="title-slide slide level1 center">
<h1>Transformation From Neural Network to Prediction Equation</h1>
<p><span class="math display">\[\widehat P =\beta_7 + \beta_8 A^{ct}_1 +  \beta_9 A^{ct}_2\]</span></p>
<ul>
<li class="fragment"><p><span class="math inline">\(A^{ct}_1\)</span> and <span class="math inline">\(A^{ct}_2\)</span> depend on <span class="math inline">\(I^{np\ eff}_1\)</span> and <span class="math inline">\(I^{np\ eff}_2\)</span> (and the <span class="math inline">\(\beta s\)</span>)</p></li>
<li class="fragment"><p><span class="math inline">\(I^{np\ eff}_1\)</span> and <span class="math inline">\(I^{np\ eff}_2\)</span> depend on the values of predictor variables <span class="math inline">\(Carat\)</span> and <span class="math inline">\(Clarity\)</span> (and the <span class="math inline">\(\beta s\)</span>)</p></li>
<li class="fragment"><p>Consequently, prediction depends only on the values of predictor variables and the <span class="math inline">\(\beta s\)</span>!»</p></li>
</ul>
</section>

<section id="transformation-from-neural-network-to-prediction-equation-1" class="title-slide slide level1 center">
<h1>Transformation From Neural Network to Prediction Equation</h1>
<p>To show the transformation, we move backwards from right to left through the neural network.</p>
<p><span class="math display">\[\widehat P =\beta_7 + \beta_8 A^{ct}_1 +  \beta_9 A^{ct}_2\]</span></p>
</section>

<section id="transformation-from-neural-network-to-prediction-equation-2" class="title-slide slide level1 center">
<h1>Transformation From Neural Network to Prediction Equation</h1>
<p><strong>Inside the Hidden Neurons:</strong></p>
<p><img data-src="Images/NeuralNetGraphGeneral.png"></p>
<p><img data-src="Images/Act1.png" class="fragment absolute" style="top: 210px; left: 490px; "> <img data-src="Images/Act2.png" class="fragment absolute" style="top: 575px; left: 490px; "></p>
</section>

<section id="transformation-from-neural-network-to-prediction-equation-3" class="title-slide slide level1 center">
<h1>Transformation From Neural Network to Prediction Equation</h1>
<p><strong>Inside the Hidden Neurons</strong></p>
<p><span class="math display">\[\widehat P =\beta_7 + \beta_8 A^{ct}_1 +  \beta_9 A^{ct}_2\]</span></p>
<p><span class="math display">\[
\widehat{P_i}=\beta_7+
\overbrace{
\frac{1}{1+e^{-I^{np\ eff}_1}}
}^{A^{ct}_1}\cdot \beta_8+
\overbrace{
\frac{1}{1+e^{-I^{np\ eff}_2}}
}^{A^{ct}_1}\cdot\beta_9
\]</span></p>
</section>

<section id="transformation-from-neural-network-to-prediction-equation-4" class="title-slide slide level1 center">
<h1>Transformation From Neural Network to Prediction Equation</h1>
<p><strong>Between the Input and the Hidden Layer:</strong></p>
<p><img data-src="Images/NeuralNetGraphGeneral.png"></p>
<p><img data-src="Images/InpEff1.png" class="fragment absolute" style="top: 278px; left: 470px; "> <img data-src="Images/InpEff2.png" class="fragment absolute" style="top: 550px; left: 470px; "></p>
</section>

<section id="transformation-from-neural-network-to-prediction-equation-5" class="title-slide slide level1 center">
<h1>Transformation From Neural Network to Prediction Equation</h1>
<p><strong>Between the Input and the Hidden Layer:</strong></p>
<p><span class="math display">\[\widehat P =\beta_7 + \beta_8 A^{ct}_1 +  \beta_9 A^{ct}_2\]</span></p>
<p><span class="math display">\[
\widehat{P_i}=\beta_7+
\overbrace{
\frac{1}{1+e^{-I^{np\ eff}_1}}
}^{A^{ct}_1}\cdot \beta_8+
\overbrace{
\frac{1}{1+e^{-I^{np\ eff}_2}}
}^{A^{ct}_1}\cdot\beta_9
\]</span></p>
<div class="fragment">
<span class="math display">\[\begin{eqnarray*}
\widehat{P_i}&amp;=&amp;\beta_7+
\overbrace{
\frac{1}{1+e^{-(\beta_1 +\beta_2 Carat_i+\beta_3 Clarity_i)}}
}^{A^{ct}_1}\cdot \beta_8\\
&amp;&amp;+
\overbrace{
\frac{1}{1+e^{-(\beta_4 +\beta_5 Carat_i+\beta_6 Clarity_i)}}
}^{A^{ct}_2}\cdot\beta_9
\end{eqnarray*}\]</span>
</div>
</section>

<section id="if-we-know-the-beta-s-we-can-generate-predictions" class="title-slide slide level1 center">
<h1>If we know the <span class="math inline">\(\beta s\)</span> We Can Generate Predictions!</h1>
<span class="math display">\[\begin{eqnarray*}
\widehat{P_i}&amp;=&amp;\beta_7\\
&amp;+&amp;\overbrace{
\frac{1}{1+e^{-(\beta_1 +\beta_2 Carat_i+\beta_3 Clarity_i)}}
}^{\mbox{$A^{ct}_1$}}\cdot \beta_8
\\
&amp;+&amp;\overbrace{
\frac{1}{1+e^{-(\beta_4 +\beta_5 Carat_i+\beta_6 Clarity_i)}}
}^{\mbox{$A^{ct}_2$}}\cdot\beta_9
\end{eqnarray*}\]</span>
<ul>
<li class="fragment"><p>initial <span class="math inline">\(\beta s\)</span> are chosen at random.</p></li>
<li class="fragment"><p>optimal <span class="math inline">\(\beta s\)</span> are found with the <em>optimizer</em>.»</p></li>
</ul>
</section>

<section id="predicting-the-first-observation-of-the-training-data" class="title-slide slide level1 center">
<h1>Predicting the First Observation of the Training Data</h1>
<p><strong>Predictor Variables’ Values:</strong> <span class="math inline">\(Carat=0.3\)</span> and <span class="math inline">\(Clarity=3\)</span></p>
</section>

<section id="predicting-the-first-observation-of-the-training-data-1" class="title-slide slide level1 center">
<h1>Predicting the First Observation of the Training Data</h1>
<p><strong>Effective Inputs:</strong> <span class="math inline">\(Carat=0.3\)</span> and <span class="math inline">\(Clarity=3\)</span></p>

<img data-src="Images/NeuralNetGraphNumbers.png" alt="Neural network with pre-selected values for the betas" class="r-stretch"></section>

<section id="predicting-the-first-observation-of-the-training-data-2" class="title-slide slide level1 center">
<h1>Predicting the First Observation of the Training Data</h1>
<p><strong>Effective Input 1:</strong> <span class="math inline">\(Carat=0.3\)</span> and <span class="math inline">\(Clarity=3\)</span></p>
<p><span class="math display">\[\beta_1 = 0.1, \beta_2=-0.9 ,\beta_3 =0.5\]</span></p>
<p><span class="math display">\[I_1^{np\ eff}=\beta_1+ \beta_2 Carat + \beta_3 Clarity\]</span></p>
<div class="fragment">
<p><span class="math display">\[I_1^{np\ eff}=\underbrace{1 \cdot 0.1}_{1 \cdot \beta_1=0.1}+\underbrace{0.3\cdot(-0.9)}_{Carat\cdot \beta_2=-0.27}+\underbrace{3\cdot 0.5}_{Clarity \cdot\beta_2=First5}=1.33\]</span></p>
</div>
</section>

<section id="predicting-the-first-observation-of-the-training-data-3" class="title-slide slide level1 center">
<h1>Predicting the First Observation of the Training Data</h1>
<p><strong>Effective Input 2:</strong> <span class="math inline">\(Carat=0.3\)</span> and <span class="math inline">\(Clarity=3\)</span></p>

<img data-src="Images/NeuralNetGraphNumbers.png" alt="Neural network with pre-selected values for the betas" class="r-stretch"></section>

<section id="predicting-the-first-observation-of-the-training-data-4" class="title-slide slide level1 center">
<h1>Predicting the First Observation of the Training Data</h1>
<p><strong>Effective Input 2:</strong> <span class="math inline">\(Carat=0.3\)</span> and <span class="math inline">\(Clarity=3\)</span></p>
<p><span class="math display">\[\beta_4 = -0.1,\beta_5 = 0.8,\beta_6 =0.6\]</span> <br></p>
<p><span class="math display">\[I_2^{np\ eff}=\beta_4+ \beta_5 Carat + \beta_6 Clarity\]</span></p>
<div class="fragment">
<p><span class="math display">\[I_2^{np\ eff}=\underbrace{1 \cdot (-0.1)}_{1 \cdot \beta_4=-0.1}+\underbrace{0.3\cdot0.8}_{Carat\cdot \beta_5=0.24}+\underbrace{3\cdot 0.6}_{Clarity \cdot\beta_6=1.8}=1.94\]</span></p>
</div>
</section>

<section id="predicting-the-first-observation-of-the-training-data-5" class="title-slide slide level1 center">
<h1>Predicting the First Observation of the Training Data</h1>
<p><strong>Hidden Neurons’ Activity:</strong> <span class="math inline">\(I_1^{np\ eff}=1.33\)</span> <span class="math inline">\(I_2^{np\ eff}=1.94\)</span></p>

<img data-src="Images/NeuralNetGraphNumbers.png" alt="Neural network with pre-selected values for the betas" class="r-stretch"></section>

<section id="predicting-the-first-observation-of-the-training-data-6" class="title-slide slide level1 center">
<h1>Predicting the First Observation of the Training Data</h1>
<p><strong>Hidden Neurons’ Activity:</strong> <span class="math inline">\(I_1^{np\ eff}=1.33\)</span> and <span class="math inline">\(I_2^{np\ eff}=1.94\)</span></p>
<p><span class="math display">\[A^{ct}_1=\frac{1}{1+e^{-I_1^{np\ eff}}}\]</span></p>
<div class="fragment">
<p><span class="math display">\[A^{ct}_1=
\frac{1}{1+e^{-1.33}}=0.79\]</span></p>
</div>
<div class="fragment">
<p><span class="math display">\[A^{ct}_2=\frac{1}{1+e^{-I_2^{np\ eff}}}\]</span></p>
</div>
<div class="fragment">
<p><span class="math display">\[A^{ct}_2=\frac{1}{1+e^{-1.94}}=0.87\]</span></p>
</div>
</section>

<section id="predicting-the-first-observation-of-the-training-data-7" class="title-slide slide level1 center">
<h1>Predicting the First Observation of the Training Data</h1>
<p><strong>Prediction:</strong> <br> <span class="math inline">\(\beta_7=0.1\)</span>, <span class="math inline">\(\beta_8=0.8\)</span>, <span class="math inline">\(\beta_9=0.9\)</span>, <span class="math inline">\(A^{ct}_1=0.79\)</span> and <span class="math inline">\(A^{ct}_2=0.87\)</span></p>

<img data-src="Images/NeuralNetGraphNumbers.png" alt="Neural network with pre-selected values for the betas" class="r-stretch"></section>

<section id="predicting-the-first-observation-of-the-training-data-8" class="title-slide slide level1 center">
<h1>Predicting the First Observation of the Training Data</h1>
<p><strong>Prediction:</strong> <br> <span class="math inline">\(\beta_7=0.1\)</span>, <span class="math inline">\(\beta_8=0.8\)</span>, <span class="math inline">\(\beta_9=0.9\)</span>, <span class="math inline">\(A^{ct}_1=0.79\)</span> and <span class="math inline">\(A^{ct}_2=0.87\)</span></p>
<p><span class="math display">\[
\widehat P =\beta_7 + \beta_8 A^{ct}_1 +  \beta_9 A^{ct}_2
\]</span></p>
<div class="fragment">
<p><span class="math display">\[
\widehat P = 0.1+0.8\cdot 0.79  +0.9 \cdot 0.87 = 1.51
\]</span></p>
<p>The predicted price for a 0.3 g diamond with a clarity level of three is $1.51. <br> <br> <strong>$1.51 for a diamond???</strong></p>
</div>
</section>

<section id="summary" class="title-slide slide level1 center">
<h1>Summary</h1>
<ul>
<li class="fragment">We can make prediction with the neural network if we know the values for the <span class="math inline">\(\beta s\)</span>. We do know the <span class="math inline">\(\beta s\)</span> because
<ul>
<li class="fragment">they are randomly chosen at the beginning, or</li>
<li class="fragment">they are adjusted by the Optimizer.</li>
</ul></li>
<li class="fragment">when <span class="math inline">\(\beta's\)</span> are randomly chosen the predictions are useually bad, but they can be improved by the <em>Optimizer</em>.</li>
</ul>
<div class="fragment">
<p>This raises the question: <br><br></p>
<p><strong>How does the <em>Optimizer</em> gradually change the</strong> <span class="math inline">\(\beta s\)</span> to improve the prediction quality of the neural network?</p>
</div>
</section>

<section id="steepest-gradient-descent" class="title-slide slide level1 center">
<h1>Steepest Gradient Descent</h1>
<p><span class="math display">\[MSE= \frac{\sum^N_{i=1}(\widehat P_i - P_i)^2}{N}\]</span></p>
<span class="math display">\[\begin{eqnarray*}
\widehat{P_i}&amp;=&amp;\beta_7\\
&amp;+&amp;\overbrace{
\frac{1}{1+e^{-(\beta_1 +\beta_2 Carat_i+\beta_3 Clarity_i)}}
}^{A^{ct}_1}\cdot \beta_8
\\
&amp;+&amp;\overbrace{
\frac{1}{1+e^{-(\beta_4 +\beta_5 Carat_i+\beta_6 Clarity_i)}}
}^{A^{ct}_2}\cdot\beta_9
\end{eqnarray*}\]</span>
</section>

<section id="steepest-gradient-descent-1" class="title-slide slide level1 smaller center">
<h1>Steepest Gradient Descent</h1>
<p><span class="math display">\[MSE= \frac{\sum^N_{i=1}(\widehat P_i - P_i)^2}{N}\]</span></p>
<span class="math display">\[\begin{eqnarray*}
MSE= \frac{\sum^N_{i=1}\left(
\left (\underbrace{\beta_7
+\overbrace{
\frac{1}{1+e^{-(\beta_1 +\beta_2 Carat_i+\beta_3 Clarity_i)}}
}^{A^{ct}_1}\cdot \beta_8
+\overbrace{
\frac{1}{1+e^{-(\beta_4 +\beta_5 Carat_i+\beta_6 Clarity_i)}}
}^{A^{ct}_2}\cdot\beta_9}_{\widehat{P_i}}  \right ) - P_i\right )^2}{N}
\end{eqnarray*}\]</span>
</section>

<section id="steepest-gradient-descent-2" class="title-slide slide level1 smaller scrollable center">
<h1>Steepest Gradient Descent</h1>
<ul>
<li class="fragment"><p>Initially <span class="math inline">\(\beta s\)</span> are chosen randomly.</p></li>
<li class="fragment"><p>Optimizer adjusts <span class="math inline">\(\beta s\)</span> incrementally (iteration by iteration; the iterations are called <strong>epochs</strong>)</p></li>
<li class="fragment"><p>Each epoch:</p>
<ul>
<li class="fragment">Find if individual <span class="math inline">\(\beta\)</span> needs to be increased or decreased.
<ul>
<li class="fragment">Increase <span class="math inline">\(\beta_i\)</span> and see if <span class="math inline">\(MSE\)</span> increases or not.</li>
<li class="fragment">Decrease <span class="math inline">\(\beta_i\)</span> and see if <span class="math inline">\(MSE\)</span> increases or not.</li>
<li class="fragment">Reset <span class="math inline">\(\beta_i\)</span> and note if <span class="math inline">\(\beta_i\)</span> needs to be increased or decreased.</li>
<li class="fragment">Repeat for all <span class="math inline">\(\beta s\)</span></li>
</ul></li>
<li class="fragment">In/Decrease <span class="math inline">\(\beta`s\)</span> proportional to change of <span class="math inline">\(MSE\)</span> caused — multiply by learning rate (e.g., 0.01) to keep change small.</li>
</ul></li>
<li class="fragment"><p>run process for several hundreds or thousands epochs.»</p></li>
</ul>
</section>

<section>
<section id="example-approximation-properties-of-neural-networks" class="title-slide slide level1 center">
<h1>Example: Approximation Properties of Neural Networks</h1>
<p>Let us run an example to see how well a Neural Network can approximate.</p>
<p>In the example we will z-normalize the predictors.</p>
<p>Are interested why?</p>
<p>Then use the <strong>down-arrow</strong> to proceed with the slides.</p>
<p>Otherwise, use the <strong>left-arrow</strong>.</p>
</section>
<section id="why-is-scaling-of-predictors-needed" class="slide level2">
<h2>Why is Scaling of Predictors Needed?</h2>

<img data-src="Images/LogisticFunction.png" class="r-stretch quarto-figure-center"><p class="caption">Logistic Activation Function</p><p>If inputs are not scaled and if they lead to very big effective inputs, the slope of the activation function will be very close to 0 and different effective inputs are indistinguishable.</p>
<div class="footer">

</div>
</section></section>
<section id="example-approximation-properties-of-neural-networks-1" class="title-slide slide level1 center">
<h1>Example: Approximation Properties of Neural Networks</h1>
<p>To run the R-script with an example to see how well a Neural Network can approximate:</p>
<p>Click the link in the footer of this slide.</p>
<div class="footer">
<p>See: <a href="https://aibookslides.netlify.app/scripts/DeepLearnScript1.R" target="blank_">Neural Network Appoximation R Script</a></p>
</div>
</section>

<section id="theorem-approximation-properties-of-neural-networks" class="title-slide slide level1 center">
<h1>Theorem: Approximation Properties of Neural Networks</h1>
<p>“Feedforward networks are capable of arbitrarily accurate approximation to any real-valued continuous function over a compact set.”</p>
<p>I.e.: Single hidden layer feedforward networks can approximate any measurable function arbitrarily well.</p>
<p><a href="https://www.cs.cmu.edu/~epxing/Class/10715/reading/Kornick_et_al.pdf" target="blank_">Kurt Hornik, Maxwell Stinchcombe and Halber White (1989), p.&nbsp;361</a></p>
</section>

<section id="intuition-approximation-properties-of-neural-networks" class="title-slide slide level1 center">
<h1>Intuition: Approximation Properties of Neural Networks</h1>
<span class="math display">\[\begin{eqnarray*}
\widehat{y_i}&amp;=&amp;\beta_{10}+
\overbrace{
\frac{1}{1+e^{-(\beta_1 x_i + \beta_2)}}
}^{\mbox{$A^{ct}_1$}}\cdot \beta_7\\
&amp;&amp;+
\overbrace{
\frac{1}{1+e^{-(\beta_3 x_i + \beta_4)}}
}^{\mbox{$A^{ct}_2$}}\cdot \beta_8\\
&amp;&amp;+
\overbrace{
\frac{1}{1+e^{-(\beta_5 x_i + \beta_6)}}
}^{\mbox{$A^{ct}_3$}}\cdot \beta_9
\end{eqnarray*}\]</span>
<p>The app linked in the footer of this slide provides intuition for the Hornik, Stinchcombe, White proof.</p>
<div class="footer">
<p>See: <a href="https://econ.lange-analytics.com/calcat/horstiwhi" target="blank_">Neural Network Appoximation App</a></p>
</div>
</section>

<section id="real-world-example-to-estimate-diamond-prices" class="title-slide slide level1 center">
<h1>Real World Example to Estimate Diamond Prices</h1>
<ol type="1">
<li class="fragment"><p>You will use all big <em>C</em> variables <span class="math inline">\(Carat\)</span>, <span class="math inline">\(Clarity\)</span>, <span class="math inline">\(Cut\)</span>, and <span class="math inline">\(Color\)</span>. <br><span class="math inline">\(Cut\)</span> describes the quality of the cut of the diamond rated from 1 (lowest) to 6 (highest) and <span class="math inline">\(Color\)</span> rates the color of a diamond from 1 (highest) to 7 (lowest)</p></li>
<li class="fragment"><p>Instead of using the <code>nnet</code> package, you will use the more advanced <code>brulee</code> package which is based on <em>PyTorch</em>, which is a Python library originally developed by <em>Facebook</em>.</p></li>
<li class="fragment"><p>We will tune the hyper-parameters of the neural network (e.g., the number of hidden units) using <em>cross validation</em>.</p></li>
</ol>
</section>

<section id="major-differences-nnet-and-bruleepytorch" class="title-slide slide level1 center">
<h1>Major Differences: <code>nnet</code> and <code>brulee</code>/<code>PyTorch</code></h1>
<ul>
<li class="fragment"><code>brulee</code> uses internally stop learning.
<ul>
<li class="fragment"><code>epoch</code> setting refers to maximum <em>epochs</em></li>
<li class="fragment">from the <em>training</em> data set a <em>validation</em> set is held back.</li>
<li class="fragment">when <em>validation error</em> stops decreasing for 5 epochs training is stopped.</li>
</ul></li>
<li class="fragment"><code>brulee</code> allows to use <strong>ReLu Activation Functions</strong></li>
</ul>
</section>

<section id="relu-activation-function" class="title-slide slide level1 center">
<h1>ReLu Activation Function</h1>
<p><span class="math display">\[Act_i=max\left (0, I_i^{eff}\right )\]</span></p>

<img data-src="DeepLearn_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch"><p>Two <em>ReLU</em> functions can be combined into one step function similar to <em>sigmoid</em> functions.</p>
<p>See the link in the footer for a demo.</p>
<div class="footer">
<p>See: <a href="https://econ.lange-analytics.com/calcat/relu" target="blank_">Combine two ReLu functions into one step function</a></p>
</div>
</section>

<section id="logistic-activation-function-problem-of-vanishing-gradient" class="title-slide slide level1 center">
<h1>Logistic Activation Function: Problem of Vanishing Gradient</h1>

<img data-src="Images/LogisticFunction.png" class="r-stretch quarto-figure-center"><p class="caption">Logistic Activation Function</p><p>Even when activation is determined somewhere in the middle of the activation function the slope is smaller than one. With multiple layers this can propagate to a gradient that is zero because slopes from multiple layers are multiplied (chain rule).</p>
</section>

<section id="relu-activation-function-no-problem-of-vanishing-gradient" class="title-slide slide level1 center">
<h1>ReLu Activation Function: No Problem of Vanishing Gradient</h1>
<p><span class="math display">\[Act_i=max\left (0, I_i^{eff}\right )\]</span></p>

<img data-src="DeepLearn_files/figure-revealjs/unnamed-chunk-4-1.png" width="960" class="r-stretch"><p><em>ReLu</em> has a slope of one.</p>
</section>

<section id="now-its-time-to-run-the-real-world-analysis" class="title-slide slide level1 center">
<h1>Now It’s Time to Run the Real-World Analysis</h1>
<p><a href="https://aibookslides.netlify.app/scripts/deeplearnscript2.R" target="blank_">Neural Network Real World Application</a></p>

</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p><a href="https://ai.lange-analytics.com" target="_blank">https://ai.lange-analytics.com/</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="DeepLearn_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="DeepLearn_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="DeepLearn_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="DeepLearn_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="DeepLearn_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="DeepLearn_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="DeepLearn_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="DeepLearn_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="DeepLearn_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="DeepLearn_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="DeepLearn_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true,"theme":"whiteboard","boardmarkerWidth":2.7},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'h.v',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'default',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>